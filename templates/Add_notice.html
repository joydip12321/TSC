{% extends "image.html" %}

{% block first %}

<div class="container mx-auto mt-5">
    <!-- Notice Form -->
    <form class="w-full max-w-lg mx-auto bg-gray-100 p-6 rounded-lg shadow-lg" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <h2 class="text-2xl font-bold mb-4" id="form-heading">Add Notice</h2>
        <hr class="mb-4"/>

        {% if messages %}
        <div class="alert alert-primary mb-4" role="alert">
            {% for message in messages %}
            <p>{{ message }}</p>
            {% endfor %}
        </div>
        {% endif %}

        <!-- Hidden Input for Notice ID (Used for updating) -->
        <input type="hidden" name="notice_id" id="notice_id">

        <!-- Title Input -->
        <div class="mb-4">
            <label for="title" class="block text-gray-700">Give a Title</label>
            <input name="title" id="title" required type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:border-blue-500"/>
        </div>

        <!-- PDF Input -->
        <div class="mb-4">
            <label for="pdf" class="block text-gray-700">Add PDF file</label>
            <input name="pdf" id="pdf" type="file" class="w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:border-blue-500"/>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200" id="submit-btn">
            Add Notice
        </button>
    </form>
</div>

<!-- Notices List -->
<div class="container mx-auto mt-10 p-4 bg-white rounded-lg shadow-lg">
    <h2 class="text-2xl font-bold text-center text-green-600 mb-6">Notices List</h2>

    <table class="min-w-full divide-y divide-gray-300">
        <thead class="bg-gray-200">
            <tr>
                <th class="px-4 py-2">Title</th>
                <th class="px-4 py-2">File</th>
                <th class="px-4 py-2">Actions</th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-300">
            {% for notice in notices %}
            <tr>
                <td class="border px-4 py-2">{{ notice.title }}</td>
                <td class="border px-4 py-2">
                    <a href="{{ notice.pdf.url }}" target="_blank" class="text-blue-500 hover:underline">View PDF</a>
                </td>
                <td class="border px-4 py-2 flex justify-center">
                    <!-- Edit Button (Fills the form with existing values) -->
                    <button onclick="editNotice('{{ notice.id }}', '{{ notice.title }}')" class="text-yellow-500 hover:text-yellow-700 mr-2" title="Update Notice">
                        <i class="fas fa-edit"></i>
                    </button>
                    <!-- Delete Button -->
                    <a href="{% url 'delete_notice' notice.id %}" class="text-red-600 hover:text-red-800" title="Delete Notice" onclick="return confirm('Are you sure you want to delete this notice?');">
                        <i class="fas fa-trash-alt"></i>
                    </a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="3" class="text-center py-4"><strong>No notices available.</strong></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- JavaScript to Fill Form for Editing -->
<script>
    function editNotice(id, title) {
        document.getElementById("notice_id").value = id;  // Set hidden input for ID
        document.getElementById("title").value = title;   // Set title input value
        document.getElementById("form-heading").textContent = "Update Notice";  // Change heading
        document.getElementById("submit-btn").textContent = "Update Notice";  // Change button text
    }
</script>

<!-- Include FontAwesome for Icons -->
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

{% endblock %}
